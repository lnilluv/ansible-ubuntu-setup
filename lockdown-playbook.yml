- name: Lock down SSH to Tailscale-only
  hosts: ubuntu_servers
  gather_facts: true
  become: true
  vars_files:
    - group_vars/all.yml
  vars:
    hardening_phase: lockdown
    ansible_user: "{{ admin_user }}"
    ansible_ssh_private_key_file: "{{ bootstrap_ssh_private_key_path }}"
  roles:
    - role: ssh
    - role: firewall
    - role: fail2ban
    - role: validation
